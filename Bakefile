# add tags and container name
TAGNAME=flask_template
CONTAINERNAME=flask_template

offline/run:
    if [ -d "./venv" ];
    then
    source venv/bin/activate
    pip3 install -r requirements.txt
    python run.py

    else
    python3 -m venv venv
    source venv/bin/activate
    pip3 install -r requirements.txt
    python run.py
    fi

docker/cleanup:@interactive
    # stop running container
    sudo docker stop $CONTAINERNAME

    # remove container
    sudo docker rm $CONTAINERNAME

    # remove previous image
    sudo docker rmi "$(docker images --format '{{.Repository}}:{{.Tag}}' | grep $TAGNAME)"

    # remove dangling images
    sudo docker image prune --force

docker/deploy: @interactive docker/cleanup
    # add option to run container in detached mode
    sudo docker-compose build
    sudo docker-compose up $DAEMON
